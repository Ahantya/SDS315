---
title: "Homework 9"
author: "Ahantya Sharma"
date: "2025-04-15"
output: pdf_document
---

### UT EID: as236366

### Github Link: <https://github.com/Ahantya/SDS315/blob/main/HW9/HW9Markdown.Rmd>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
library(ggplot2)
library(knitr)
library(scales)
library(tidyverse)
library(kableExtra)
library(parameters)
library(mosaic)
library(dplyr)
solder = read.csv("solder.csv")
grocery = read.csv("groceries.csv")
redlining = read.csv("redlining.csv")
```

# Problem 1 - Manufacturing flaws in circuit boards

## Part A. 

```{r echo=FALSE}

ggplot(solder, aes(x = Opening, y = skips)) +
  geom_boxplot() +
  labs(title = "Number of Skips by Solder Gun Opening Size",
       x = "Opening Size",
       y = "Number of Skips") +
  theme_minimal()


```

This boxplot shows that as the opening size is smaller, the number of skips is higher on average. 

```{r echo=FALSE}

ggplot(solder, aes(x = Solder, y = skips)) +
  geom_boxplot() +
  labs(title = "Number of Skips by Solder Thickness",
       x = "Solder Thickness",
       y = "Number of Skips") +
  theme_minimal()


```

This boxplot shows that a thinner solder has a larger number of skips on average than the thicker solder. 

## Part B.

```{r echo=FALSE}


skipsInteraction <- do(10000) * lm(skips ~ Opening + Solder + Opening:Solder, data = resample(solder))

confint(skipsInteraction, level = 0.95)

```

## Part C.

The baseline number of skips for a large opening and thick solder is about 0.3933, with an increase of 2.4067 for a medium opening and 5.1267 for a small opening. When the solder is thin, skips increase by 2.28 with a large opening, decrease by 0.74 with a medium opening, and increase by 9.6533 with a small opening, relative to the baseline.

## Part D.
According to the regression model, I would recommend a combination of a thick solder with a large opening to AT&T because it's reported to have the least amount of skips. 


# Problem 2 - Grocery store prices

## Part A. 

```{r echo=FALSE}

avgPriceByStore <- group_by(grocery, Store)

avgPriceByStore <- summarize(avgPriceByStore, avgPrice = mean(Price))

ggplot(avgPriceByStore, aes(x = Store, y = avgPrice)) +
  geom_col(fill = "orange") +
  coord_flip() +
  labs(
    title = "Average Product Price by Store",
    x = "Store",
    y = "Average Price (USD)"
  )

```
This bar graph shows the average price of an item in each store, specifically pointing that Whole Foods being the most expensive in terms of average price and Fiesta being the cheapest in terms of average price. 

## Part B. 

```{r echo=FALSE, fig.height=12, fig.width=8}

productDistinct <- distinct(grocery, Product, Store) # finds unique amount of products 

productCounts <- group_by(productDistinct, Product)

productCounts <- summarize(productCounts, numStores = n()) # gets the count for each product

ggplot(productCounts, aes(x = Product, y = numStores)) +
  geom_col(fill = "darkorange") +
  coord_flip() +
  labs(
    title = "Number of Stores Selling Each Product",
    x = "Product",
    y = "Number of Stores") 

```
This bar graph shows the item availability by the number of stores, so the most common available items include Carton of eggs, Horizon 2% Milk Cartons, and Iodized Salt while the least common available items include Frosted Flakes 1lb, El Milagros Tortilla Chips, Cinnamon Toast Crunch 1lb, and Lucky Charms 1lb. 

## Part C. 

```{r echo=FALSE}
productTypeLM <- lm(Price ~ Product + Type, data = grocery)

confint(productTypeLM, level=0.95)

```

Compared with ordinary grocery stores (like Albertsons, HEB, or Krogers), convenience stores charge somewhere between 0.41 to 0.92 dollars more for the same product. 

## Part D. 

```{r echo=FALSE}

productStoreLM <- lm(Price ~ Product + Store, data = grocery)

coef(productStoreLM, level=0.95)




```

The two stores seem to charge the lowest prices when comparing the same product are Kroger Fresh Fare and Walmart. The two stores that seem to charge the highest prices when comparing the same product are Wheatsville Food Co-Op and Whole Foods.  

## Part E. 

Knowing that H-E-B's coefficient is approximately -0.646 and Central Market's coefficient is approximately -0.573, we can say that the average price difference between Central Market and H-E-B is small (about 7 cents), while also noting that there is a huge overlap in both confidence intervals. Therefore, we can say Central Market charges a similar amount to H-E-B for the same product.

## Part F. 

```{r echo=FALSE}

grocery <- mutate(grocery, Income10K = Income / 10000)

incomeLM <- lm(Price ~ Product + Income10K, data = grocery)

coef(incomeLM)




```


The sign of the Income10K coefficient, which is negative, so this means that when the average income increases, the price of items decreases. By the linear model trend, this means that poorer ZIP codes will usually be paying more for the same product, on average.

```{r echo=FALSE}

standardize_parameters(incomeLM)[standardize_parameters(incomeLM)$Parameter == "Income10K", ]



```

A one-standard deviation increase in the income of a ZIP code seems to be associated with
a -0.03 standard-deviation change in the price that consumers in that ZIP code expect to pay for the same product. 